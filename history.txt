npm init // express 빌드
server config // 서버설정값들


// // // server 빌드 \\ \\ \\
포스트맨으로 api 체크

|||||||||||||||||||||||||

// // // client 빌드 \\ \\ \\
npx create-react-app 으로 빌드


|||||||||||||||||||||||||


// // // pakege \\ \\ \\
dev 모드에서만 nodemon 사용

|||||||||||||||||||||||||

// // // user model \\ \\ \\
받아오는 정보는 최소화 // id, password, role, token정보, token 유효기간 만 받아옴

password bcrypt 로 암호화

세션 대신 JWT 사용이유?
현재 사용되는 웹표준 인증방식.

|||||||||||||||||||||||||


OCI ssh 접속방법
현재 window terminals 의 기본위치는 user.cskim 으로 되어있음.
따라서 그 안에있는 my_key.key (프라이빗키) 를 사용해서 다음 명령어 실행
ssh -i my_key.key ubuntu@MY-ubuntu-IPADRESS

위를통해 ubuntu@mysecond... : 에 접속한다면 성공한 것. 이미 node-module 등은 설치해두었음.
하지만 server/config/prod.js 를 받아오는 경우의 실행프로세스가 틀렸다고 함 고쳐야함.

vim /env/profile
내에 export 를 추가해주는것으로 환경변수 MONGO_URI 추가 성공
instance access IP MONGODB whitelist 에 추가해주고

오라클 클라우드 방화벽과 우분투 터미널 내 방화벽 iptable 의 5000번 포트 꺼주는것으로 작동 확인

터미널에서의 npm run 은 성공했으나, 터미널을 끄면 서버도 꺼지는 문제

pm2 를 통해 서버 24시간 구동 성공

자꾸 proxy error 발생. 혹시 시간문제인가 해서 npt 사용 시간동기화

찾아보니 proxy-middleware 와 body-parser 의 충돌문제
iptables -I INPUT 1 -p tcp --dport 80 -j ACCEPT

npm run build 시 build index.html 의 정적요소들은 적용되었으나, 그 외의것은 전혀 없음.
https://sangmin802.github.io/Study/Think/cra-build/
내 문제와 가장 가까워보이는 문제를 다루는 곳.
=> 위 글에서 추측한대로 Router 를 인식하지 못한문제가 맞아보임
=> client 의 app에서 BrowserRouter 를 HashRouter 로 바꿔줘서 해결완료.

또 새로운 문제 배포단계에서의 proxy가 작동하지 않음.
다만, 콘솔에 뜨는 오류가 직관적이어서 쉽게 알순있었음.
=> 환경변수 설정으로 해결할수있었음

해결하고나니까 이번엔 https / http Mixed Contents ERROR 를 뱉어냄 개가튼거
무료 ssl 인증 certbot 은 IP주소는 ssl인증을 해주지 않아서 
[내도메인.한국/] 에서 내 도메인을 만들어서 OCI 인스턴스와 연결해주었다.
이후 prod/dev 에서 사용했던 환경변수 MONGO_URI 를 통해 dev모드인지 prod 모드인지 구분해서 hosting 해줌

이번엔 또 cors 에러때문에 server side에서 cors 설정. 나는 서버에서 쿠키까지 사용하기에 credentials 도 넣어주어야함

프론트에서의 cors 에러 // 서버에서만 Credentials 설정할것이 아니라 쿠키를 받아오는 프론트 요청에서도
withCredentials : true 요소를 넘겨주어야만함